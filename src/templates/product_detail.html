{% extends 'base.html' %}

{% block title %}
{{ product.name }}
{% endblock %}

{% block content %}

<h2>{{ product.name }}</h2>

<p><strong>Danh mục:</strong> {{ product.category.name }}</p>
<p><strong>Giá:</strong> {{ product.price }} VNĐ</p>
<p><strong>Tồn kho:</strong> {{ product.stock }}</p>

{% if product.image %}
    <img src="{{ product.image.url }}" alt="{{ product.name }}" width="300">
{% endif %}

<p>{{ product.description }}</p>

{% if product.stock > 0 %}
    <button class="add-to-cart-btn" data-product-id="{{ product.id }}">
        Thêm vào giỏ
    </button>
{% else %}
    <p style="color:red;">Hết hàng</p>
{% endif %}

<script>
document.querySelector('.add-to-cart-btn')?.addEventListener('click', function () {
    const productId = this.dataset.productId;

    fetch(`/add-to-cart/${productId}/`, {
        method: 'POST',
        headers: {
            'X-CSRFToken': '{{ csrf_token }}',
        },
    })
    .then(res => res.json())
    .then(data => {
        if (data.success) {
            alert(data.message);
        }
    });
});
</script>

{% endblock %}
